"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/subscription/status/route";
exports.ids = ["app/api/subscription/status/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubscription%2Fstatus%2Froute&page=%2Fapi%2Fsubscription%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubscription%2Fstatus%2Froute.ts&appDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubscription%2Fstatus%2Froute&page=%2Fapi%2Fsubscription%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubscription%2Fstatus%2Froute.ts&appDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_daniel_Code_10_project_Game_server_app_api_subscription_status_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/subscription/status/route.ts */ \"(rsc)/./app/api/subscription/status/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/subscription/status/route\",\n        pathname: \"/api/subscription/status\",\n        filename: \"route\",\n        bundlePath: \"app/api/subscription/status/route\"\n    },\n    resolvedPagePath: \"/Users/daniel/Code/10_project/Game/server/app/api/subscription/status/route.ts\",\n    nextConfigOutput,\n    userland: _Users_daniel_Code_10_project_Game_server_app_api_subscription_status_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/subscription/status/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdWJzY3JpcHRpb24lMkZzdGF0dXMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN1YnNjcmlwdGlvbiUyRnN0YXR1cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN1YnNjcmlwdGlvbiUyRnN0YXR1cyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmRhbmllbCUyRkNvZGUlMkYxMF9wcm9qZWN0JTJGR2FtZSUyRnNlcnZlciUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZkYW5pZWwlMkZDb2RlJTJGMTBfcHJvamVjdCUyRkdhbWUlMkZzZXJ2ZXImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzhCO0FBQzNHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGdhbWUtYWkvc2VydmVyLz80M2IyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9kYW5pZWwvQ29kZS8xMF9wcm9qZWN0L0dhbWUvc2VydmVyL2FwcC9hcGkvc3Vic2NyaXB0aW9uL3N0YXR1cy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc3Vic2NyaXB0aW9uL3N0YXR1cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N1YnNjcmlwdGlvbi9zdGF0dXNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N1YnNjcmlwdGlvbi9zdGF0dXMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvZGFuaWVsL0NvZGUvMTBfcHJvamVjdC9HYW1lL3NlcnZlci9hcHAvYXBpL3N1YnNjcmlwdGlvbi9zdGF0dXMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3N1YnNjcmlwdGlvbi9zdGF0dXMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubscription%2Fstatus%2Froute&page=%2Fapi%2Fsubscription%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubscription%2Fstatus%2Froute.ts&appDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/subscription/status/route.ts":
/*!**********************************************!*\
  !*** ./app/api/subscription/status/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./lib/mongodb.ts\");\n/* harmony import */ var _lib_address_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/address-utils */ \"(rsc)/./lib/address-utils.ts\");\n/**\n * 订阅状态查询 API 路由\n *\n * 功能：查询用户当前的订阅状态\n *\n * 请求方式: GET /api/subscription/status?address=0x...\n *\n * 响应格式:\n * {\n *   \"isActive\": true,\n *   \"expiresAt\": 1729876000,        // Unix timestamp\n *   \"daysRemaining\": 15,\n *   \"transactionHash\": \"0x...\",\n *   \"startedAt\": 1729271200\n * }\n */ \n\n\nasync function GET(request) {\n    try {\n        // 获取查询参数\n        const searchParams = request.nextUrl.searchParams;\n        const userAddress = searchParams.get(\"address\");\n        // 参数验证\n        if (!userAddress) {\n            console.warn(\"[Subscription Status API] 缺少必需参数: address\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required parameter: address\"\n            }, {\n                status: 400\n            });\n        }\n        // 验证地址格式\n        if (!(0,_lib_address_utils__WEBPACK_IMPORTED_MODULE_2__.isValidAddress)(userAddress)) {\n            console.warn(\"[Subscription Status API] 无效的钱包地址:\", userAddress);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid wallet address format\"\n            }, {\n                status: 400\n            });\n        }\n        const normalizedAddress = (0,_lib_address_utils__WEBPACK_IMPORTED_MODULE_2__.normalizeAddress)(userAddress);\n        console.log(\"[Subscription Status API] 查询订阅状态，用户地址:\", normalizedAddress);\n        // 连接数据库\n        const db = await (0,_lib_mongodb__WEBPACK_IMPORTED_MODULE_1__.connectDB)();\n        // 查询订阅记录\n        const subscription = await db.collection(\"subscriptions\").findOne({\n            userAddress: normalizedAddress\n        });\n        if (!subscription) {\n            console.log(\"[Subscription Status API] 未找到订阅记录\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                isActive: false,\n                expiresAt: null,\n                daysRemaining: 0,\n                transactionHash: null,\n                startedAt: null\n            }, {\n                status: 200\n            });\n        }\n        // 检查订阅是否过期\n        const now = Math.floor(Date.now() / 1000) // 转换为秒级 Unix 时间戳\n        ;\n        const isActive = subscription.status === \"active\" && subscription.expiresAt > now;\n        const daysRemaining = isActive ? Math.ceil((subscription.expiresAt - now) / (24 * 3600)) : 0;\n        console.log(\"[Subscription Status API] 订阅状态:\", isActive ? \"有效\" : \"已过期\", \"剩余天数:\", daysRemaining);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            isActive,\n            expiresAt: subscription.expiresAt,\n            daysRemaining,\n            transactionHash: subscription.transactionHash,\n            startedAt: subscription.startedAt\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"[Subscription Status API] 处理请求失败:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to query subscription status\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * 处理 OPTIONS 请求（用于 CORS 预检）\n */ async function OPTIONS() {\n    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N1YnNjcmlwdGlvbi9zdGF0dXMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7Ozs7O0NBZUMsR0FFc0Q7QUFDZDtBQUM2QjtBQUUvRCxlQUFlSSxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsU0FBUztRQUNULE1BQU1DLGVBQWVELFFBQVFFLE9BQU8sQ0FBQ0QsWUFBWTtRQUNqRCxNQUFNRSxjQUFjRixhQUFhRyxHQUFHLENBQUM7UUFFckMsT0FBTztRQUNQLElBQUksQ0FBQ0QsYUFBYTtZQUNoQkUsUUFBUUMsSUFBSSxDQUFDO1lBQ2IsT0FBT1gscURBQVlBLENBQUNZLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU87WUFDVCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxTQUFTO1FBQ1QsSUFBSSxDQUFDWixrRUFBY0EsQ0FBQ00sY0FBYztZQUNoQ0UsUUFBUUMsSUFBSSxDQUFDLHNDQUFzQ0g7WUFDbkQsT0FBT1IscURBQVlBLENBQUNZLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU87WUFDVCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxvQkFBb0JaLG9FQUFnQkEsQ0FBQ0s7UUFDM0NFLFFBQVFNLEdBQUcsQ0FBQywwQ0FBMENEO1FBRXRELFFBQVE7UUFDUixNQUFNRSxLQUFLLE1BQU1oQix1REFBU0E7UUFFMUIsU0FBUztRQUNULE1BQU1pQixlQUFlLE1BQU1ELEdBQUdFLFVBQVUsQ0FBQyxpQkFBaUJDLE9BQU8sQ0FBQztZQUNoRVosYUFBYU87UUFDZjtRQUVBLElBQUksQ0FBQ0csY0FBYztZQUNqQlIsUUFBUU0sR0FBRyxDQUFDO1lBQ1osT0FBT2hCLHFEQUFZQSxDQUFDWSxJQUFJLENBQ3RCO2dCQUNFUyxVQUFVO2dCQUNWQyxXQUFXO2dCQUNYQyxlQUFlO2dCQUNmQyxpQkFBaUI7Z0JBQ2pCQyxXQUFXO1lBQ2IsR0FDQTtnQkFBRVgsUUFBUTtZQUFJO1FBRWxCO1FBRUEsV0FBVztRQUNYLE1BQU1ZLE1BQU1DLEtBQUtDLEtBQUssQ0FBQ0MsS0FBS0gsR0FBRyxLQUFLLE1BQU0saUJBQWlCOztRQUMzRCxNQUFNTCxXQUFXSCxhQUFhSixNQUFNLEtBQUssWUFBWUksYUFBYUksU0FBUyxHQUFHSTtRQUM5RSxNQUFNSCxnQkFBZ0JGLFdBQ2xCTSxLQUFLRyxJQUFJLENBQUMsQ0FBQ1osYUFBYUksU0FBUyxHQUFHSSxHQUFFLElBQU0sTUFBSyxJQUFHLEtBQ3BEO1FBRUpoQixRQUFRTSxHQUFHLENBQUMsbUNBQW1DSyxXQUFXLE9BQU8sT0FBTyxTQUFTRTtRQUVqRixPQUFPdkIscURBQVlBLENBQUNZLElBQUksQ0FDdEI7WUFDRVM7WUFDQUMsV0FBV0osYUFBYUksU0FBUztZQUNqQ0M7WUFDQUMsaUJBQWlCTixhQUFhTSxlQUFlO1lBQzdDQyxXQUFXUCxhQUFhTyxTQUFTO1FBQ25DLEdBQ0E7WUFBRVgsUUFBUTtRQUFJO0lBRWxCLEVBQUUsT0FBT0QsT0FBTztRQUNkSCxRQUFRRyxLQUFLLENBQUMscUNBQXFDQTtRQUNuRCxPQUFPYixxREFBWUEsQ0FBQ1ksSUFBSSxDQUN0QjtZQUNFQyxPQUFPO1lBQ1BrQixTQUFTbEIsaUJBQWlCbUIsUUFBUW5CLE1BQU1vQixPQUFPLEdBQUc7UUFDcEQsR0FDQTtZQUFFbkIsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVvQjtJQUNwQixPQUFPLElBQUlsQyxxREFBWUEsQ0FBQyxNQUFNO1FBQzVCYyxRQUFRO1FBQ1JxQixTQUFTO1lBQ1AsK0JBQStCO1lBQy9CLGdDQUFnQztZQUNoQyxnQ0FBZ0M7UUFDbEM7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGdhbWUtYWkvc2VydmVyLy4vYXBwL2FwaS9zdWJzY3JpcHRpb24vc3RhdHVzL3JvdXRlLnRzP2JmZjciXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDorqLpmIXnirbmgIHmn6Xor6IgQVBJIOi3r+eUsVxuICpcbiAqIOWKn+iDve+8muafpeivoueUqOaIt+W9k+WJjeeahOiuoumYheeKtuaAgVxuICpcbiAqIOivt+axguaWueW8jzogR0VUIC9hcGkvc3Vic2NyaXB0aW9uL3N0YXR1cz9hZGRyZXNzPTB4Li4uXG4gKlxuICog5ZON5bqU5qC85byPOlxuICoge1xuICogICBcImlzQWN0aXZlXCI6IHRydWUsXG4gKiAgIFwiZXhwaXJlc0F0XCI6IDE3Mjk4NzYwMDAsICAgICAgICAvLyBVbml4IHRpbWVzdGFtcFxuICogICBcImRheXNSZW1haW5pbmdcIjogMTUsXG4gKiAgIFwidHJhbnNhY3Rpb25IYXNoXCI6IFwiMHguLi5cIixcbiAqICAgXCJzdGFydGVkQXRcIjogMTcyOTI3MTIwMFxuICogfVxuICovXG5cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNvbm5lY3REQiB9IGZyb20gJ0AvbGliL21vbmdvZGInXG5pbXBvcnQgeyBpc1ZhbGlkQWRkcmVzcywgbm9ybWFsaXplQWRkcmVzcyB9IGZyb20gJ0AvbGliL2FkZHJlc3MtdXRpbHMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyDojrflj5bmn6Xor6Llj4LmlbBcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zXG4gICAgY29uc3QgdXNlckFkZHJlc3MgPSBzZWFyY2hQYXJhbXMuZ2V0KCdhZGRyZXNzJylcblxuICAgIC8vIOWPguaVsOmqjOivgVxuICAgIGlmICghdXNlckFkZHJlc3MpIHtcbiAgICAgIGNvbnNvbGUud2FybignW1N1YnNjcmlwdGlvbiBTdGF0dXMgQVBJXSDnvLrlsJHlv4XpnIDlj4LmlbA6IGFkZHJlc3MnKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7XG4gICAgICAgICAgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIHBhcmFtZXRlcjogYWRkcmVzcycsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIOmqjOivgeWcsOWdgOagvOW8j1xuICAgIGlmICghaXNWYWxpZEFkZHJlc3ModXNlckFkZHJlc3MpKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tTdWJzY3JpcHRpb24gU3RhdHVzIEFQSV0g5peg5pWI55qE6ZKx5YyF5Zyw5Z2AOicsIHVzZXJBZGRyZXNzKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7XG4gICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHdhbGxldCBhZGRyZXNzIGZvcm1hdCcsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IG5vcm1hbGl6ZWRBZGRyZXNzID0gbm9ybWFsaXplQWRkcmVzcyh1c2VyQWRkcmVzcylcbiAgICBjb25zb2xlLmxvZygnW1N1YnNjcmlwdGlvbiBTdGF0dXMgQVBJXSDmn6Xor6LorqLpmIXnirbmgIHvvIznlKjmiLflnLDlnYA6Jywgbm9ybWFsaXplZEFkZHJlc3MpXG5cbiAgICAvLyDov57mjqXmlbDmja7lupNcbiAgICBjb25zdCBkYiA9IGF3YWl0IGNvbm5lY3REQigpXG5cbiAgICAvLyDmn6Xor6LorqLpmIXorrDlvZVcbiAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJykuZmluZE9uZSh7XG4gICAgICB1c2VyQWRkcmVzczogbm9ybWFsaXplZEFkZHJlc3MsXG4gICAgfSlcblxuICAgIGlmICghc3Vic2NyaXB0aW9uKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1N1YnNjcmlwdGlvbiBTdGF0dXMgQVBJXSDmnKrmib7liLDorqLpmIXorrDlvZUnKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7XG4gICAgICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgICAgIGV4cGlyZXNBdDogbnVsbCxcbiAgICAgICAgICBkYXlzUmVtYWluaW5nOiAwLFxuICAgICAgICAgIHRyYW5zYWN0aW9uSGFzaDogbnVsbCxcbiAgICAgICAgICBzdGFydGVkQXQ6IG51bGwsXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiAyMDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIOajgOafpeiuoumYheaYr+WQpui/h+acn1xuICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApIC8vIOi9rOaNouS4uuenkue6pyBVbml4IOaXtumXtOaIs1xuICAgIGNvbnN0IGlzQWN0aXZlID0gc3Vic2NyaXB0aW9uLnN0YXR1cyA9PT0gJ2FjdGl2ZScgJiYgc3Vic2NyaXB0aW9uLmV4cGlyZXNBdCA+IG5vd1xuICAgIGNvbnN0IGRheXNSZW1haW5pbmcgPSBpc0FjdGl2ZVxuICAgICAgPyBNYXRoLmNlaWwoKHN1YnNjcmlwdGlvbi5leHBpcmVzQXQgLSBub3cpIC8gKDI0ICogMzYwMCkpXG4gICAgICA6IDBcblxuICAgIGNvbnNvbGUubG9nKCdbU3Vic2NyaXB0aW9uIFN0YXR1cyBBUEldIOiuoumYheeKtuaAgTonLCBpc0FjdGl2ZSA/ICfmnInmlYgnIDogJ+W3sui/h+acnycsICfliankvZnlpKnmlbA6JywgZGF5c1JlbWFpbmluZylcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgaXNBY3RpdmUsXG4gICAgICAgIGV4cGlyZXNBdDogc3Vic2NyaXB0aW9uLmV4cGlyZXNBdCxcbiAgICAgICAgZGF5c1JlbWFpbmluZyxcbiAgICAgICAgdHJhbnNhY3Rpb25IYXNoOiBzdWJzY3JpcHRpb24udHJhbnNhY3Rpb25IYXNoLFxuICAgICAgICBzdGFydGVkQXQ6IHN1YnNjcmlwdGlvbi5zdGFydGVkQXQsXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDIwMCB9XG4gICAgKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tTdWJzY3JpcHRpb24gU3RhdHVzIEFQSV0g5aSE55CG6K+35rGC5aSx6LSlOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gcXVlcnkgc3Vic2NyaXB0aW9uIHN0YXR1cycsXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhiBPUFRJT05TIOivt+axgu+8iOeUqOS6jiBDT1JTIOmihOajgO+8iVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gT1BUSU9OUygpIHtcbiAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UobnVsbCwge1xuICAgIHN0YXR1czogMjAwLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcyc6ICdHRVQsIE9QVElPTlMnLFxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnOiAnQ29udGVudC1UeXBlJyxcbiAgICB9LFxuICB9KVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNvbm5lY3REQiIsImlzVmFsaWRBZGRyZXNzIiwibm9ybWFsaXplQWRkcmVzcyIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwidXNlckFkZHJlc3MiLCJnZXQiLCJjb25zb2xlIiwid2FybiIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsIm5vcm1hbGl6ZWRBZGRyZXNzIiwibG9nIiwiZGIiLCJzdWJzY3JpcHRpb24iLCJjb2xsZWN0aW9uIiwiZmluZE9uZSIsImlzQWN0aXZlIiwiZXhwaXJlc0F0IiwiZGF5c1JlbWFpbmluZyIsInRyYW5zYWN0aW9uSGFzaCIsInN0YXJ0ZWRBdCIsIm5vdyIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJjZWlsIiwiZGV0YWlscyIsIkVycm9yIiwibWVzc2FnZSIsIk9QVElPTlMiLCJoZWFkZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/subscription/status/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/address-utils.ts":
/*!******************************!*\
  !*** ./lib/address-utils.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isValidAddress: () => (/* binding */ isValidAddress),\n/* harmony export */   isValidTransactionHash: () => (/* binding */ isValidTransactionHash),\n/* harmony export */   normalizeAddress: () => (/* binding */ normalizeAddress)\n/* harmony export */ });\n/**\n * 地址验证和规范化工具\n * 独立于 ethers，避免 Next.js 兼容性问题\n */ /**\n * 验证是否为有效的以太坊地址\n * @param address 地址字符串\n * @returns 是否有效\n */ function isValidAddress(address) {\n    return /^0x[a-fA-F0-9]{40}$/.test(address);\n}\n/**\n * 规范化地址为小写格式\n * @param address 地址字符串\n * @returns 规范化后的地址\n */ function normalizeAddress(address) {\n    if (!isValidAddress(address)) {\n        throw new Error(\"Invalid address format\");\n    }\n    return address.toLowerCase();\n}\n/**\n * 验证交易哈希格式\n * @param hash 交易哈希\n * @returns 是否有效\n */ function isValidTransactionHash(hash) {\n    return /^0x[a-fA-F0-9]{64}$/.test(hash);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWRkcmVzcy11dGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7O0NBR0MsR0FFRDs7OztDQUlDLEdBQ00sU0FBU0EsZUFBZUMsT0FBZTtJQUM1QyxPQUFPLHNCQUFzQkMsSUFBSSxDQUFDRDtBQUNwQztBQUVBOzs7O0NBSUMsR0FDTSxTQUFTRSxpQkFBaUJGLE9BQWU7SUFDOUMsSUFBSSxDQUFDRCxlQUFlQyxVQUFVO1FBQzVCLE1BQU0sSUFBSUcsTUFBTTtJQUNsQjtJQUNBLE9BQU9ILFFBQVFJLFdBQVc7QUFDNUI7QUFFQTs7OztDQUlDLEdBQ00sU0FBU0MsdUJBQXVCQyxJQUFZO0lBQ2pELE9BQU8sc0JBQXNCTCxJQUFJLENBQUNLO0FBQ3BDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGdhbWUtYWkvc2VydmVyLy4vbGliL2FkZHJlc3MtdXRpbHMudHM/NjNmMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIOWcsOWdgOmqjOivgeWSjOinhOiMg+WMluW3peWFt1xuICog54us56uL5LqOIGV0aGVyc++8jOmBv+WFjSBOZXh0LmpzIOWFvOWuueaAp+mXrumimFxuICovXG5cbi8qKlxuICog6aqM6K+B5piv5ZCm5Li65pyJ5pWI55qE5Lul5aSq5Z2K5Zyw5Z2AXG4gKiBAcGFyYW0gYWRkcmVzcyDlnLDlnYDlrZfnrKbkuLJcbiAqIEByZXR1cm5zIOaYr+WQpuacieaViFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZEFkZHJlc3MoYWRkcmVzczogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAvXjB4W2EtZkEtRjAtOV17NDB9JC8udGVzdChhZGRyZXNzKVxufVxuXG4vKipcbiAqIOinhOiMg+WMluWcsOWdgOS4uuWwj+WGmeagvOW8j1xuICogQHBhcmFtIGFkZHJlc3Mg5Zyw5Z2A5a2X56ym5LiyXG4gKiBAcmV0dXJucyDop4TojIPljJblkI7nmoTlnLDlnYBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUFkZHJlc3MoYWRkcmVzczogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKCFpc1ZhbGlkQWRkcmVzcyhhZGRyZXNzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhZGRyZXNzIGZvcm1hdCcpXG4gIH1cbiAgcmV0dXJuIGFkZHJlc3MudG9Mb3dlckNhc2UoKVxufVxuXG4vKipcbiAqIOmqjOivgeS6pOaYk+WTiOW4jOagvOW8j1xuICogQHBhcmFtIGhhc2gg5Lqk5piT5ZOI5biMXG4gKiBAcmV0dXJucyDmmK/lkKbmnInmlYhcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRUcmFuc2FjdGlvbkhhc2goaGFzaDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAvXjB4W2EtZkEtRjAtOV17NjR9JC8udGVzdChoYXNoKVxufVxuIl0sIm5hbWVzIjpbImlzVmFsaWRBZGRyZXNzIiwiYWRkcmVzcyIsInRlc3QiLCJub3JtYWxpemVBZGRyZXNzIiwiRXJyb3IiLCJ0b0xvd2VyQ2FzZSIsImlzVmFsaWRUcmFuc2FjdGlvbkhhc2giLCJoYXNoIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/address-utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.ts":
/*!************************!*\
  !*** ./lib/mongodb.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cleanupExpiredSubscriptions: () => (/* binding */ cleanupExpiredSubscriptions),\n/* harmony export */   closeDB: () => (/* binding */ closeDB),\n/* harmony export */   connectDB: () => (/* binding */ connectDB),\n/* harmony export */   getDB: () => (/* binding */ getDB),\n/* harmony export */   initializeDatabase: () => (/* binding */ initializeDatabase)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n/**\n * MongoDB 连接管理模块\n * 使用单例模式缓存连接，避免每次重复连接\n */ \nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017\";\nconst MONGODB_DB_NAME = process.env.MONGODB_DB_NAME || \"game-ai\";\n/**\n * 缓存的连接实例\n */ let cachedClient = null;\nlet cachedDb = null;\n/**\n * 连接到 MongoDB\n * 使用单例模式确保只创建一个连接\n */ async function connectDB() {\n    // 如果已有连接，直接返回\n    if (cachedClient && cachedDb) {\n        console.log(\"[MongoDB] 使用缓存连接\");\n        return cachedDb;\n    }\n    try {\n        console.log(\"[MongoDB] 正在连接...\");\n        const client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(MONGODB_URI, {\n            maxPoolSize: 10,\n            minPoolSize: 2,\n            maxIdleTimeMS: 60000\n        });\n        await client.connect();\n        console.log(\"[MongoDB] 连接成功\");\n        // 获取数据库实例\n        const db = client.db(MONGODB_DB_NAME);\n        // 缓存连接和数据库实例\n        cachedClient = client;\n        cachedDb = db;\n        return db;\n    } catch (error) {\n        console.error(\"[MongoDB] 连接失败:\", error);\n        throw error;\n    }\n}\n/**\n * 关闭 MongoDB 连接\n */ async function closeDB() {\n    if (cachedClient) {\n        await cachedClient.close();\n        cachedClient = null;\n        cachedDb = null;\n        console.log(\"[MongoDB] 连接已关闭\");\n    }\n}\n/**\n * 获取当前数据库实例\n */ function getDB() {\n    if (!cachedDb) {\n        throw new Error(\"Database not connected. Call connectDB() first.\");\n    }\n    return cachedDb;\n}\n/**\n * 创建必要的集合和索引\n */ async function initializeDatabase() {\n    try {\n        const db = await connectDB();\n        console.log(\"[MongoDB] 初始化数据库...\");\n        // 创建 subscriptions 集合\n        try {\n            await db.createCollection(\"subscriptions\");\n            console.log(\"[MongoDB] subscriptions 集合已创建\");\n        } catch (error) {\n            if (error.code === 48) {\n                // 集合已存在\n                console.log(\"[MongoDB] subscriptions 集合已存在\");\n            } else {\n                throw error;\n            }\n        }\n        // 创建 subscriptions 索引\n        await db.collection(\"subscriptions\").createIndex({\n            userAddress: 1\n        }, {\n            unique: true\n        });\n        console.log(\"[MongoDB] subscriptions.userAddress 唯一索引已创建\");\n        await db.collection(\"subscriptions\").createIndex({\n            expiresAt: 1\n        });\n        console.log(\"[MongoDB] subscriptions.expiresAt 索引已创建\");\n        await db.collection(\"subscriptions\").createIndex({\n            status: 1\n        });\n        console.log(\"[MongoDB] subscriptions.status 索引已创建\");\n        // 创建 chat_logs 集合（可选）\n        try {\n            await db.createCollection(\"chat_logs\");\n            console.log(\"[MongoDB] chat_logs 集合已创建\");\n        } catch (error) {\n            if (error.code === 48) {\n                console.log(\"[MongoDB] chat_logs 集合已存在\");\n            } else {\n                throw error;\n            }\n        }\n        // 创建 chat_logs 索引\n        await db.collection(\"chat_logs\").createIndex({\n            userAddress: 1\n        });\n        console.log(\"[MongoDB] chat_logs.userAddress 索引已创建\");\n        await db.collection(\"chat_logs\").createIndex({\n            timestamp: 1\n        });\n        console.log(\"[MongoDB] chat_logs.timestamp 索引已创建\");\n        // 创建 gameContent 集合\n        try {\n            await db.createCollection(\"gameContent\");\n            console.log(\"[MongoDB] gameContent 集合已创建\");\n        } catch (error) {\n            if (error.code === 48) {\n                console.log(\"[MongoDB] gameContent 集合已存在\");\n            } else {\n                throw error;\n            }\n        }\n        // 创建 gameContent 索引\n        await db.collection(\"gameContent\").createIndex({\n            contentId: 1\n        }, {\n            unique: true\n        });\n        console.log(\"[MongoDB] gameContent.contentId 唯一索引已创建\");\n        await db.collection(\"gameContent\").createIndex({\n            userAddress: 1\n        });\n        console.log(\"[MongoDB] gameContent.userAddress 索引已创建\");\n        await db.collection(\"gameContent\").createIndex({\n            gameTitle: 1\n        });\n        console.log(\"[MongoDB] gameContent.gameTitle 索引已创建\");\n        await db.collection(\"gameContent\").createIndex({\n            createdAt: 1\n        });\n        console.log(\"[MongoDB] gameContent.createdAt 索引已创建\");\n        // 创建 dividendWithdrawals 集合\n        try {\n            await db.createCollection(\"dividendWithdrawals\");\n            console.log(\"[MongoDB] dividendWithdrawals 集合已创建\");\n        } catch (error) {\n            if (error.code === 48) {\n                console.log(\"[MongoDB] dividendWithdrawals 集合已存在\");\n            } else {\n                throw error;\n            }\n        }\n        // 创建 dividendWithdrawals 索引\n        await db.collection(\"dividendWithdrawals\").createIndex({\n            withdrawalId: 1\n        }, {\n            unique: true\n        });\n        console.log(\"[MongoDB] dividendWithdrawals.withdrawalId 唯一索引已创建\");\n        await db.collection(\"dividendWithdrawals\").createIndex({\n            userAddress: 1\n        });\n        console.log(\"[MongoDB] dividendWithdrawals.userAddress 索引已创建\");\n        await db.collection(\"dividendWithdrawals\").createIndex({\n            transactionHash: 1\n        });\n        console.log(\"[MongoDB] dividendWithdrawals.transactionHash 索引已创建\");\n        await db.collection(\"dividendWithdrawals\").createIndex({\n            createdAt: 1\n        });\n        console.log(\"[MongoDB] dividendWithdrawals.createdAt 索引已创建\");\n        await db.collection(\"dividendWithdrawals\").createIndex({\n            status: 1\n        });\n        console.log(\"[MongoDB] dividendWithdrawals.status 索引已创建\");\n        console.log(\"[MongoDB] 数据库初始化完成\");\n    } catch (error) {\n        console.error(\"[MongoDB] 初始化失败:\", error);\n        throw error;\n    }\n}\n/**\n * 清理过期的订阅\n * 定期调用此函数删除已过期的订阅记录\n */ async function cleanupExpiredSubscriptions() {\n    try {\n        const db = await connectDB();\n        const now = Math.floor(Date.now() / 1000);\n        const result = await db.collection(\"subscriptions\").deleteMany({\n            expiresAt: {\n                $lt: now\n            },\n            status: \"inactive\"\n        });\n        console.log(`[MongoDB] 已清理 ${result.deletedCount} 条过期订阅记录`);\n        return result.deletedCount;\n    } catch (error) {\n        console.error(\"[MongoDB] 清理过期订阅失败:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1NLEdBQUdTLFVBQVUsQ0FBQyx1QkFBdUJDLFdBQVcsQ0FBQztZQUFFVSxpQkFBaUI7UUFBRTtRQUM1RTNCLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1NLEdBQUdTLFVBQVUsQ0FBQyx1QkFBdUJDLFdBQVcsQ0FBQztZQUFFUSxXQUFXO1FBQUU7UUFDdEV6QixRQUFRQyxHQUFHLENBQUM7UUFFWixNQUFNTSxHQUFHUyxVQUFVLENBQUMsdUJBQXVCQyxXQUFXLENBQUM7WUFBRUksUUFBUTtRQUFFO1FBQ25FckIsUUFBUUMsR0FBRyxDQUFDO1FBRVpELFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT08sT0FBTztRQUNkUixRQUFRUSxLQUFLLENBQUMsb0JBQW9CQTtRQUNsQyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQTs7O0NBR0MsR0FDTSxlQUFlb0I7SUFDcEIsSUFBSTtRQUNGLE1BQU1yQixLQUFLLE1BQU1SO1FBQ2pCLE1BQU04QixNQUFNQyxLQUFLQyxLQUFLLENBQUNDLEtBQUtILEdBQUcsS0FBSztRQUVwQyxNQUFNSSxTQUFTLE1BQU0xQixHQUFHUyxVQUFVLENBQUMsaUJBQWlCa0IsVUFBVSxDQUFDO1lBQzdEZCxXQUFXO2dCQUFFZSxLQUFLTjtZQUFJO1lBQ3RCUixRQUFRO1FBQ1Y7UUFFQXJCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGNBQWMsRUFBRWdDLE9BQU9HLFlBQVksQ0FBQyxRQUFRLENBQUM7UUFDMUQsT0FBT0gsT0FBT0csWUFBWTtJQUM1QixFQUFFLE9BQU81QixPQUFPO1FBQ2RSLFFBQVFRLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0BnYW1lLWFpL3NlcnZlci8uL2xpYi9tb25nb2RiLnRzPzA1YmQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNb25nb0RCIOi/nuaOpeeuoeeQhuaooeWdl1xuICog5L2/55So5Y2V5L6L5qih5byP57yT5a2Y6L+e5o6l77yM6YG/5YWN5q+P5qyh6YeN5aSN6L+e5o6lXG4gKi9cblxuaW1wb3J0IHsgTW9uZ29DbGllbnQsIERiIH0gZnJvbSAnbW9uZ29kYidcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSSB8fCAnbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNydcbmNvbnN0IE1PTkdPREJfREJfTkFNRSA9IHByb2Nlc3MuZW52Lk1PTkdPREJfREJfTkFNRSB8fCAnZ2FtZS1haSdcblxuLyoqXG4gKiDnvJPlrZjnmoTov57mjqXlrp7kvotcbiAqL1xubGV0IGNhY2hlZENsaWVudDogTW9uZ29DbGllbnQgfCBudWxsID0gbnVsbFxubGV0IGNhY2hlZERiOiBEYiB8IG51bGwgPSBudWxsXG5cbi8qKlxuICog6L+e5o6l5YiwIE1vbmdvREJcbiAqIOS9v+eUqOWNleS+i+aooeW8j+ehruS/neWPquWIm+W7uuS4gOS4qui/nuaOpVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29ubmVjdERCKCk6IFByb21pc2U8RGI+IHtcbiAgLy8g5aaC5p6c5bey5pyJ6L+e5o6l77yM55u05o6l6L+U5ZueXG4gIGlmIChjYWNoZWRDbGllbnQgJiYgY2FjaGVkRGIpIHtcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIOS9v+eUqOe8k+WtmOi/nuaOpScpXG4gICAgcmV0dXJuIGNhY2hlZERiXG4gIH1cblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0g5q2j5Zyo6L+e5o6lLi4uJylcblxuICAgIGNvbnN0IGNsaWVudCA9IG5ldyBNb25nb0NsaWVudChNT05HT0RCX1VSSSEsIHtcbiAgICAgIG1heFBvb2xTaXplOiAxMCxcbiAgICAgIG1pblBvb2xTaXplOiAyLFxuICAgICAgbWF4SWRsZVRpbWVNUzogNjAwMDAsXG4gICAgfSlcblxuICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KClcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIOi/nuaOpeaIkOWKnycpXG5cbiAgICAvLyDojrflj5bmlbDmja7lupPlrp7kvotcbiAgICBjb25zdCBkYiA9IGNsaWVudC5kYihNT05HT0RCX0RCX05BTUUpXG5cbiAgICAvLyDnvJPlrZjov57mjqXlkozmlbDmja7lupPlrp7kvotcbiAgICBjYWNoZWRDbGllbnQgPSBjbGllbnRcbiAgICBjYWNoZWREYiA9IGRiXG5cbiAgICByZXR1cm4gZGJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTW9uZ29EQl0g6L+e5o6l5aSx6LSlOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuLyoqXG4gKiDlhbPpl60gTW9uZ29EQiDov57mjqVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsb3NlREIoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChjYWNoZWRDbGllbnQpIHtcbiAgICBhd2FpdCBjYWNoZWRDbGllbnQuY2xvc2UoKVxuICAgIGNhY2hlZENsaWVudCA9IG51bGxcbiAgICBjYWNoZWREYiA9IG51bGxcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIOi/nuaOpeW3suWFs+mXrScpXG4gIH1cbn1cblxuLyoqXG4gKiDojrflj5blvZPliY3mlbDmja7lupPlrp7kvotcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldERCKCk6IERiIHtcbiAgaWYgKCFjYWNoZWREYikge1xuICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2Ugbm90IGNvbm5lY3RlZC4gQ2FsbCBjb25uZWN0REIoKSBmaXJzdC4nKVxuICB9XG4gIHJldHVybiBjYWNoZWREYlxufVxuXG4vKipcbiAqIOWIm+W7uuW/heimgeeahOmbhuWQiOWSjOe0ouW8lVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFiYXNlKCk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGRiID0gYXdhaXQgY29ubmVjdERCKClcblxuICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0g5Yid5aeL5YyW5pWw5o2u5bqTLi4uJylcblxuICAgIC8vIOWIm+W7uiBzdWJzY3JpcHRpb25zIOmbhuWQiFxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi5jcmVhdGVDb2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJylcbiAgICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0gc3Vic2NyaXB0aW9ucyDpm4blkIjlt7LliJvlu7onKVxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSA0OCkge1xuICAgICAgICAvLyDpm4blkIjlt7LlrZjlnKhcbiAgICAgICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBzdWJzY3JpcHRpb25zIOmbhuWQiOW3suWtmOWcqCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnJvclxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIOWIm+W7uiBzdWJzY3JpcHRpb25zIOe0ouW8lVxuICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3N1YnNjcmlwdGlvbnMnKS5jcmVhdGVJbmRleChcbiAgICAgIHsgdXNlckFkZHJlc3M6IDEgfSxcbiAgICAgIHsgdW5pcXVlOiB0cnVlIH1cbiAgICApXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBzdWJzY3JpcHRpb25zLnVzZXJBZGRyZXNzIOWUr+S4gOe0ouW8leW3suWIm+W7uicpXG5cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJykuY3JlYXRlSW5kZXgoeyBleHBpcmVzQXQ6IDEgfSlcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIHN1YnNjcmlwdGlvbnMuZXhwaXJlc0F0IOe0ouW8leW3suWIm+W7uicpXG5cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdzdWJzY3JpcHRpb25zJykuY3JlYXRlSW5kZXgoeyBzdGF0dXM6IDEgfSlcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIHN1YnNjcmlwdGlvbnMuc3RhdHVzIOe0ouW8leW3suWIm+W7uicpXG5cbiAgICAvLyDliJvlu7ogY2hhdF9sb2dzIOmbhuWQiO+8iOWPr+mAie+8iVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkYi5jcmVhdGVDb2xsZWN0aW9uKCdjaGF0X2xvZ3MnKVxuICAgICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBjaGF0X2xvZ3Mg6ZuG5ZCI5bey5Yib5bu6JylcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gNDgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBjaGF0X2xvZ3Mg6ZuG5ZCI5bey5a2Y5ZyoJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGVycm9yXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g5Yib5bu6IGNoYXRfbG9ncyDntKLlvJVcbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdjaGF0X2xvZ3MnKS5jcmVhdGVJbmRleCh7IHVzZXJBZGRyZXNzOiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBjaGF0X2xvZ3MudXNlckFkZHJlc3Mg57Si5byV5bey5Yib5bu6JylcblxuICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2NoYXRfbG9ncycpLmNyZWF0ZUluZGV4KHsgdGltZXN0YW1wOiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBjaGF0X2xvZ3MudGltZXN0YW1wIOe0ouW8leW3suWIm+W7uicpXG5cbiAgICAvLyDliJvlu7ogZ2FtZUNvbnRlbnQg6ZuG5ZCIXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGRiLmNyZWF0ZUNvbGxlY3Rpb24oJ2dhbWVDb250ZW50JylcbiAgICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0gZ2FtZUNvbnRlbnQg6ZuG5ZCI5bey5Yib5bu6JylcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gNDgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBnYW1lQ29udGVudCDpm4blkIjlt7LlrZjlnKgnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDliJvlu7ogZ2FtZUNvbnRlbnQg57Si5byVXG4gICAgYXdhaXQgZGIuY29sbGVjdGlvbignZ2FtZUNvbnRlbnQnKS5jcmVhdGVJbmRleCh7IGNvbnRlbnRJZDogMSB9LCB7IHVuaXF1ZTogdHJ1ZSB9KVxuICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0gZ2FtZUNvbnRlbnQuY29udGVudElkIOWUr+S4gOe0ouW8leW3suWIm+W7uicpXG5cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdnYW1lQ29udGVudCcpLmNyZWF0ZUluZGV4KHsgdXNlckFkZHJlc3M6IDEgfSlcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIGdhbWVDb250ZW50LnVzZXJBZGRyZXNzIOe0ouW8leW3suWIm+W7uicpXG5cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdnYW1lQ29udGVudCcpLmNyZWF0ZUluZGV4KHsgZ2FtZVRpdGxlOiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBnYW1lQ29udGVudC5nYW1lVGl0bGUg57Si5byV5bey5Yib5bu6JylcblxuICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2dhbWVDb250ZW50JykuY3JlYXRlSW5kZXgoeyBjcmVhdGVkQXQ6IDEgfSlcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIGdhbWVDb250ZW50LmNyZWF0ZWRBdCDntKLlvJXlt7LliJvlu7onKVxuXG4gICAgLy8g5Yib5bu6IGRpdmlkZW5kV2l0aGRyYXdhbHMg6ZuG5ZCIXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGRiLmNyZWF0ZUNvbGxlY3Rpb24oJ2RpdmlkZW5kV2l0aGRyYXdhbHMnKVxuICAgICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBkaXZpZGVuZFdpdGhkcmF3YWxzIOmbhuWQiOW3suWIm+W7uicpXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09IDQ4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0gZGl2aWRlbmRXaXRoZHJhd2FscyDpm4blkIjlt7LlrZjlnKgnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDliJvlu7ogZGl2aWRlbmRXaXRoZHJhd2FscyDntKLlvJVcbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdkaXZpZGVuZFdpdGhkcmF3YWxzJykuY3JlYXRlSW5kZXgoeyB3aXRoZHJhd2FsSWQ6IDEgfSwgeyB1bmlxdWU6IHRydWUgfSlcbiAgICBjb25zb2xlLmxvZygnW01vbmdvREJdIGRpdmlkZW5kV2l0aGRyYXdhbHMud2l0aGRyYXdhbElkIOWUr+S4gOe0ouW8leW3suWIm+W7uicpXG5cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdkaXZpZGVuZFdpdGhkcmF3YWxzJykuY3JlYXRlSW5kZXgoeyB1c2VyQWRkcmVzczogMSB9KVxuICAgIGNvbnNvbGUubG9nKCdbTW9uZ29EQl0gZGl2aWRlbmRXaXRoZHJhd2Fscy51c2VyQWRkcmVzcyDntKLlvJXlt7LliJvlu7onKVxuXG4gICAgYXdhaXQgZGIuY29sbGVjdGlvbignZGl2aWRlbmRXaXRoZHJhd2FscycpLmNyZWF0ZUluZGV4KHsgdHJhbnNhY3Rpb25IYXNoOiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBkaXZpZGVuZFdpdGhkcmF3YWxzLnRyYW5zYWN0aW9uSGFzaCDntKLlvJXlt7LliJvlu7onKVxuXG4gICAgYXdhaXQgZGIuY29sbGVjdGlvbignZGl2aWRlbmRXaXRoZHJhd2FscycpLmNyZWF0ZUluZGV4KHsgY3JlYXRlZEF0OiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBkaXZpZGVuZFdpdGhkcmF3YWxzLmNyZWF0ZWRBdCDntKLlvJXlt7LliJvlu7onKVxuXG4gICAgYXdhaXQgZGIuY29sbGVjdGlvbignZGl2aWRlbmRXaXRoZHJhd2FscycpLmNyZWF0ZUluZGV4KHsgc3RhdHVzOiAxIH0pXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSBkaXZpZGVuZFdpdGhkcmF3YWxzLnN0YXR1cyDntKLlvJXlt7LliJvlu7onKVxuXG4gICAgY29uc29sZS5sb2coJ1tNb25nb0RCXSDmlbDmja7lupPliJ3lp4vljJblrozmiJAnKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tNb25nb0RCXSDliJ3lp4vljJblpLHotKU6JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG4vKipcbiAqIOa4heeQhui/h+acn+eahOiuoumYhVxuICog5a6a5pyf6LCD55So5q2k5Ye95pWw5Yig6Zmk5bey6L+H5pyf55qE6K6i6ZiF6K6w5b2VXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhbnVwRXhwaXJlZFN1YnNjcmlwdGlvbnMoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYiA9IGF3YWl0IGNvbm5lY3REQigpXG4gICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMClcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3N1YnNjcmlwdGlvbnMnKS5kZWxldGVNYW55KHtcbiAgICAgIGV4cGlyZXNBdDogeyAkbHQ6IG5vdyB9LFxuICAgICAgc3RhdHVzOiAnaW5hY3RpdmUnLFxuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZyhgW01vbmdvREJdIOW3sua4heeQhiAke3Jlc3VsdC5kZWxldGVkQ291bnR9IOadoei/h+acn+iuoumYheiusOW9lWApXG4gICAgcmV0dXJuIHJlc3VsdC5kZWxldGVkQ291bnRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbTW9uZ29EQl0g5riF55CG6L+H5pyf6K6i6ZiF5aSx6LSlOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsIk1PTkdPREJfVVJJIiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfREJfTkFNRSIsImNhY2hlZENsaWVudCIsImNhY2hlZERiIiwiY29ubmVjdERCIiwiY29uc29sZSIsImxvZyIsImNsaWVudCIsIm1heFBvb2xTaXplIiwibWluUG9vbFNpemUiLCJtYXhJZGxlVGltZU1TIiwiY29ubmVjdCIsImRiIiwiZXJyb3IiLCJjbG9zZURCIiwiY2xvc2UiLCJnZXREQiIsIkVycm9yIiwiaW5pdGlhbGl6ZURhdGFiYXNlIiwiY3JlYXRlQ29sbGVjdGlvbiIsImNvZGUiLCJjb2xsZWN0aW9uIiwiY3JlYXRlSW5kZXgiLCJ1c2VyQWRkcmVzcyIsInVuaXF1ZSIsImV4cGlyZXNBdCIsInN0YXR1cyIsInRpbWVzdGFtcCIsImNvbnRlbnRJZCIsImdhbWVUaXRsZSIsImNyZWF0ZWRBdCIsIndpdGhkcmF3YWxJZCIsInRyYW5zYWN0aW9uSGFzaCIsImNsZWFudXBFeHBpcmVkU3Vic2NyaXB0aW9ucyIsIm5vdyIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJyZXN1bHQiLCJkZWxldGVNYW55IiwiJGx0IiwiZGVsZXRlZENvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubscription%2Fstatus%2Froute&page=%2Fapi%2Fsubscription%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubscription%2Fstatus%2Froute.ts&appDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fdaniel%2FCode%2F10_project%2FGame%2Fserver&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();